# OOD detection between Lucchi (ID) and Droso (target) on the Mac.
# Update the dataset + checkpoint paths before running:
#   python ood-detection.py --cfg config/mac/ood_detection_mac.yaml

experiment_id: "2025-12-16_B2_droso-vs-testlucchi_dinov2-base_lora-r16_ood"
results_root: "/Users/cfuste/Documents/Results/DINO-LoRA"
task_type: "ood-detection"

data:
  id:
    path: "/Users/cfuste/Documents/Data/ElectronMicroscopy/Droso/Train_In"
    recursive: true
    file_glob: ["*.png", "*.tif"]
    sequence_regex: '(?i)droso[_-]*(\d+)'
  target:
    path: "/Users/cfuste/Documents/Data/ElectronMicroscopy/Lucchi++/Test_In"
    recursive: true
    file_glob: ["*.png", "*.tif"]
    sequence_regex: '(?i)lucchi[_-]*(\d+)'
    # file_list: "/path/to/target_list.txt"   # optional filter (one path per line)

model:
  dino_size: "base"
  checkpoint: "/Volumes/G_MLS_VU_Group$/caterina/cluster-backup/seg/droso-lora/seg/2025-12-11_A2_droso-only_dinov2-base_lora-r16_seg_drosogrid62821_rep2_s2_base/ckpts/best_model.pt"
  pooling: "mean"
  l2_normalize: true

runtime:
  batch_size: 2
  num_workers: 0
  seed: 0
  img_size:
    mode: longest_edge
    target: 1022
    patch_multiple: 14
    rounding: floor
  device: "auto"

ood:
  cache_embeddings: true
  covariance:
    method: "ledoit-wolf"    # "oas" or "empirical" also supported
    reg_eps: 0.0001
  threshold:
    quantile: 0.95
  topk: 24
  outlier_grid_topk: 12
  outlier_grid_cols: 4
